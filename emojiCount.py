#!/usr/bin/env python3

import json

stickers = ['[å¾®ç¬‘]','[æ’‡å˜´]','[è‰²]','[å‘å‘†]','[å¾—æ„]','[æµæ³ª]','[å®³ç¾]','[é—­å˜´]','[ç¡]','[å¤§å“­]','[å°´å°¬]','[å‘æ€’]','[è°ƒçš®]','[å‘²ç‰™]','[æƒŠè®¶]','[éš¾è¿‡]','[å›§]','[æŠ“ç‹‚]','[å]','[å·ç¬‘]','[æ„‰å¿«]','[ç™½çœ¼]','[å‚²æ…¢]','[å›°]','[æƒŠæ]','[æ†¨ç¬‘]','[æ‚ é—²]','[å’’éª‚]','[ç–‘é—®]','[å˜˜]','[æ™•]','[è¡°]','[éª·é«…]','[æ•²æ‰“]','[å†è§]','[æ“¦æ±—]','[æŠ é¼»]','[é¼“æŒ]','[åç¬‘]','[å³å“¼å“¼]','[é„™è§†]','[å§”å±ˆ]','[å¿«å“­äº†]','[é˜´é™©]','[äº²äº²]','[å¯æ€œ]','[ç¬‘è„¸]','[ç”Ÿç—…]','[è„¸çº¢]','[ç ´æ¶•ä¸ºç¬‘]','[ææƒ§]','[å¤±æœ›]','[æ— è¯­]','[å˜¿å“ˆ]','[æ‚è„¸]','[å¥¸ç¬‘]','[æœºæ™º]','[çš±çœ‰]','[è€¶]','[åƒç“œ]','[åŠ æ²¹]','[æ±—]','[å¤©å•Š]','[Emm]','[ç¤¾ä¼šç¤¾ä¼š]','[æ—ºæŸ´]','[å¥½çš„]','[æ‰“è„¸]','[å“‡]','[ç¿»ç™½çœ¼]','[666]','[è®©æˆ‘çœ‹çœ‹]','[å¹æ°”]','[è‹¦æ¶©]','[è£‚å¼€]','[å˜´å”‡]','[çˆ±å¿ƒ]','[å¿ƒç¢]','[æ‹¥æŠ±]','[å¼º]','[å¼±]','[æ¡æ‰‹]','[èƒœåˆ©]','[æŠ±æ‹³]','[å‹¾å¼•]','[æ‹³å¤´]','[OK]','[åˆå]','[å•¤é…’]','[å’–å•¡]','[è›‹ç³•]','[ç«ç‘°]','[å‡‹è°¢]','[èœåˆ€]','[ç‚¸å¼¹]','[ä¾¿ä¾¿]','[æœˆäº®]','[å¤ªé˜³]','[åº†ç¥]','[ç¤¼ç‰©]','[çº¢åŒ…]','[ç™¼]','[ç¦]','[çƒŸèŠ±]','[çˆ†ç«¹]','[çŒªå¤´]','[è·³è·³]','[å‘æŠ–]','[è½¬åœˆ]']
# é™¤äº†å¾®ä¿¡è‡ªå¸¦çš„è¡¨æƒ…ï¼Œæ·»åŠ ä¸€äº›å¸¸ç”¨çš„ Emoji è¡¨æƒ…ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥æ·»åŠ ä¸€äº›æƒ³è¦ç»Ÿè®¡çš„å•è¯
stickers.extend(['ğŸ˜‚','ğŸ¤£','ğŸ¥°','ğŸ˜…','ğŸ¥¹','ğŸ˜˜','ğŸ¤©','ğŸ¥º','ğŸ˜“','ğŸ™„','ğŸ¤¡', 'å“ˆå“ˆ'])
stickers_dict = {stickers: 0 for stickers in stickers}

data = open('/Users/james/Desktop/WeChatDB/db8/Chat_c361fce587751cedffb3e34d40fddb6b.json')
data = data.read()
data = json.loads(data)

for item in data:
    for word in stickers_dict.keys():
        stickers_dict[word] += item['msgContent'].count(word)

# å‰”é™¤è®¡æ•°ä¸º 0 çš„è¡¨æƒ…
data = {key: value for key, value in stickers_dict.items() if value != 0}

import pandas as pd
# ä½¿ç”¨ DataFrame.from_dict() å°†å­—å…¸è½¬æ¢ä¸º DataFrame
df = pd.DataFrame.from_dict(data, orient='index', columns=['æ•°é‡'])

# æ·»åŠ è¡¨æƒ…åˆ—
df['è¡¨æƒ…'] = df.index

# æŒ‰æ•°é‡é™åºæ’åº
df = df.sort_values(by='æ•°é‡', ascending=False)

# é‡ç½®ç´¢å¼•
df = df[['è¡¨æƒ…', 'æ•°é‡']]
df = df.reset_index(drop=True)

# ä¿å­˜ DataFrame åˆ° Excel æ–‡ä»¶
df.to_excel('~/Desktop/emoji_data.xlsx', index=False)

print("æ•°æ®å·²ä¿å­˜åˆ° ~/Desktop/emoji_data.xlsx æ–‡ä»¶ä¸­ã€‚")
